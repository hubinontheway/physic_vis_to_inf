lr: 0.0001
batch_size: 64 # A100 显存充足，建议保持较大 batch 提高稳定性
image_size: 256
steps: 200000
eval_interval: 5000
vis_interval: 5000
lr_schedule:
  type: cosine
  warmup_steps: 2000
  min_lr: 0.000001

eval_split: test
eval_batch_size: 32
best_metric: psnr
best_metric_mode: max
max_checkpoints: 5

dataset: VEDIA
split: train
data_root: /data2/hubin/datasets
seed: 123
device: cuda:5 # 现已支持指定显卡

# --- Advanced Flow Model Configuration (Slightly Reduced) ---
flow_model:
  block_out_channels: [128, 256, 512, 512] # 减小了最后一层的规模
  layers_per_block: 2 # 减小了深度

  down_block_types: 
    - "DownBlock2D"
    - "DownBlock2D"
    - "AttnDownBlock2D"
    - "AttnDownBlock2D"
  up_block_types: 
    - "AttnUpBlock2D"
    - "AttnUpBlock2D"
    - "UpBlock2D"
    - "UpBlock2D"

  attention_head_dim: 64       
  dropout: 0.0                 
  act_fn: "silu"               
  center_input_sample: false   

flow_sampling:
  method: euler
  steps: 50
  atol: 0.00001
  rtol: 0.00001
